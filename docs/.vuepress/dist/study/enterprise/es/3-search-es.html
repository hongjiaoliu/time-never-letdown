<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.60" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://liuhongjiao.cn/study/enterprise/es/3-search-es.html"><meta property="og:site_name" content="L - 时光不负"><meta property="og:title" content="3-检索进阶"><meta property="og:description" content="3-检索进阶 本节参考 官方文档 检索示例： 导入样本测试数据 准备一份顾客银行账户信息的虚构的JSON文档样本。每个文档都有下列的 schema（模式）。 { "account_number": 1, "balance": 39225, "firstname": "Amber", "lastname": "Duke", "age": 32, "gender": "M", "address": "880 Holmes Lane", "employer": "Pyrami", "email": "amberduke@pyrami.com", "city": "Brogan", "state": "IL" }"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-02-17T01:29:56.000Z"><meta property="article:tag" content="ElasticSearch"><meta property="article:published_time" content="2022-05-03T00:00:00.000Z"><meta property="article:modified_time" content="2023-02-17T01:29:56.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"3-检索进阶","image":[""],"datePublished":"2022-05-03T00:00:00.000Z","dateModified":"2023-02-17T01:29:56.000Z","author":[]}</script><meta name="baidu_union_verify" content="0b1f86cf9f95a06866dba08d15b9504d"><title>3-检索进阶 | L - 时光不负</title><meta name="description" content="3-检索进阶 本节参考 官方文档 检索示例： 导入样本测试数据 准备一份顾客银行账户信息的虚构的JSON文档样本。每个文档都有下列的 schema（模式）。 { "account_number": 1, "balance": 39225, "firstname": "Amber", "lastname": "Duke", "age": 32, "gender": "M", "address": "880 Holmes Lane", "employer": "Pyrami", "email": "amberduke@pyrami.com", "city": "Brogan", "state": "IL" }">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-8f77a4da.css" as="style"><link rel="stylesheet" href="/assets/style-8f77a4da.css">
    <link rel="modulepreload" href="/assets/app-8869829a.js"><link rel="modulepreload" href="/assets/framework-bcbeea85.js"><link rel="modulepreload" href="/assets/3-search-es.html-8a452684.js"><link rel="modulepreload" href="/assets/3-search-es.html-97c9c0f6.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.svg" alt="L - 时光不负"><!----><span class="site-name hide-in-pad">L - 时光不负</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="博客首页"><span class="font-icon icon iconfont icon-home" style=""></span>博客首页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/pw/" class="nav-link" aria-label="个人建站"><span class="font-icon icon iconfont icon-discover" style=""></span>个人建站<!----></a></div><div class="nav-item hide-in-mobile"><a href="/study/" class="nav-link active" aria-label="聚水成川"><span class="font-icon icon iconfont icon-note" style=""></span>聚水成川<!----></a></div><div class="nav-item hide-in-mobile"><a href="/pits/" class="nav-link" aria-label="踩坑系列"><span class="font-icon icon iconfont icon-edit" style=""></span>踩坑系列<!----></a></div><div class="nav-item hide-in-mobile"><a href="/essay/" class="nav-link" aria-label="随记日常"><span class="font-icon icon iconfont icon-note" style=""></span>随记日常<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!----><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/study/" class="nav-link sidebar-link sidebar-page" aria-label="Study"><!---->Study<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-java" style=""></span><span class="title">一、Core-Java</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="font-icon icon iconfont icon-advance" style=""></span><span class="title">二、Java企业级开发</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">2.1、Spring</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">2.2、SpringMVC</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">2.3、SpringBoot</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">2.4、Dubbo</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">2.5、Nginx</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">2.6、ElasticSearch</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/study/enterprise/es/1-overview-es.html" class="nav-link sidebar-link sidebar-page" aria-label="1-介绍与安装"><span class="font-icon icon iconfont icon-edit" style=""></span>1-介绍与安装<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/study/enterprise/es/2-hello-es.html" class="nav-link sidebar-link sidebar-page" aria-label="2-使用入门"><span class="font-icon icon iconfont icon-edit" style=""></span>2-使用入门<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/study/enterprise/es/3-search-es.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="3-检索进阶"><span class="font-icon icon iconfont icon-edit" style=""></span>3-检索进阶<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#请求接口" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="请求接口"><!---->请求接口<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#结果" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="结果"><!---->结果<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#响应字段解释" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="响应字段解释"><!---->响应字段解释<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#响应结果说明" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="响应结果说明"><!---->响应结果说明<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#请求方式说明" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="请求方式说明"><!---->请求方式说明<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_1-基本语法格式" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1. 基本语法格式"><!---->1. 基本语法格式<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_2-返回部分字段" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2. 返回部分字段"><!---->2. 返回部分字段<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_3-match-匹配查询" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3. match-匹配查询"><!---->3. match-匹配查询<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#精确查询-基本数据类型-非文本" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="精确查询-基本数据类型(非文本)"><!---->精确查询-基本数据类型(非文本)<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#模糊查询-文本字符串" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="模糊查询-文本字符串"><!---->模糊查询-文本字符串<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#精确匹配-文本字符串" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="精确匹配-文本字符串"><!---->精确匹配-文本字符串<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_4-match-phrase-短语匹配" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4. match_phrase-短语匹配"><!---->4. match_phrase-短语匹配<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_5-multi-math-多字段匹配" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5. multi_math-多字段匹配"><!---->5. multi_math-多字段匹配<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_6-bool-复合查询" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6. bool-复合查询"><!---->6. bool-复合查询<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_7-filter-结果过滤" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7. filter-结果过滤"><!---->7. filter-结果过滤<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_8-term-精确检索" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8. term-精确检索"><!---->8. term-精确检索<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_9-aggregation-执行聚合" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="9. Aggregation-执行聚合"><!---->9. Aggregation-执行聚合<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#聚合语法" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="聚合语法"><!---->聚合语法<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#示例1-搜索address中包含mill的所有人的年龄分布以及平均年龄" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="示例1-搜索address中包含mill的所有人的年龄分布以及平均年龄"><!---->示例1-搜索address中包含mill的所有人的年龄分布以及平均年龄<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#示例2-按照年龄聚合-并且求这些年龄段的这些人的平均薪资" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="示例2-按照年龄聚合，并且求这些年龄段的这些人的平均薪资"><!---->示例2-按照年龄聚合，并且求这些年龄段的这些人的平均薪资<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#示例3-查出所有年龄分布-并且这些年龄段中m的平均薪资和f的平均薪资以及这个年龄段的总体平均薪资" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="示例3-查出所有年龄分布，并且这些年龄段中M的平均薪资和F的平均薪资以及这个年龄段的总体平均薪资"><!---->示例3-查出所有年龄分布，并且这些年龄段中M的平均薪资和F的平均薪资以及这个年龄段的总体平均薪资<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/study/enterprise/es/4-mapping-es.html" class="nav-link sidebar-link sidebar-page" aria-label="4-Mapping"><span class="font-icon icon iconfont icon-edit" style=""></span>4-Mapping<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/study/enterprise/es/5-analysis-es.html" class="nav-link sidebar-link sidebar-page" aria-label="5-分词"><span class="font-icon icon iconfont icon-edit" style=""></span>5-分词<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/study/enterprise/es/6-cerebro-es.html" class="nav-link sidebar-link sidebar-page" aria-label="6-cerebro可视化"><span class="font-icon icon iconfont icon-edit" style=""></span>6-cerebro可视化<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">2.7、ZooKeeper</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">2.8、Docker</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">2.9、K8S</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">2.10、Mybatis</span><span class="arrow right"></span></button><!----></section></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-mysql" style=""></span><span class="title">三、数据库</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-structure" style=""></span><span class="title">四、通用技能</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-more" style=""></span><span class="title">五、扩展系列</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-more" style=""></span><span class="title">六、提效工具</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-discover" style=""></span><span class="title">踩坑系列</span><span class="arrow right"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="font-icon icon iconfont icon-edit" style=""></span>3-检索进阶</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://liuhongjiao.cn" target="_blank" rel="noopener noreferrer">哇哩哇哩哇</a></span><span property="author" content="哇哩哇哩哇"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-05-03T00:00:00.000Z"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="page-category-item category7 clickable" role="navigation">Java企业开发</span><meta property="articleSection" content="Java企业开发"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><span class="page-tag-item tag0 clickable" role="navigation">ElasticSearch</span><meta property="keywords" content="ElasticSearch"></span><span class="page-word-info" aria-label="字数🔠" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>约 3180 字</span><meta property="wordCount" content="3180"></span><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 11 分钟</span><meta property="timeRequired" content="PT11M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容<button class="print-button" title="print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#请求接口" class="router-link-active router-link-exact-active toc-link level2">请求接口</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#结果" class="router-link-active router-link-exact-active toc-link level2">结果</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#响应字段解释" class="router-link-active router-link-exact-active toc-link level2">响应字段解释</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#响应结果说明" class="router-link-active router-link-exact-active toc-link level2">响应结果说明</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#请求方式说明" class="router-link-active router-link-exact-active toc-link level2">请求方式说明</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_1-基本语法格式" class="router-link-active router-link-exact-active toc-link level2">1. 基本语法格式</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_2-返回部分字段" class="router-link-active router-link-exact-active toc-link level2">2. 返回部分字段</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_3-match-匹配查询" class="router-link-active router-link-exact-active toc-link level2">3. match-匹配查询</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#精确查询-基本数据类型-非文本" class="router-link-active router-link-exact-active toc-link level3">精确查询-基本数据类型(非文本)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#模糊查询-文本字符串" class="router-link-active router-link-exact-active toc-link level3">模糊查询-文本字符串</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#精确匹配-文本字符串" class="router-link-active router-link-exact-active toc-link level3">精确匹配-文本字符串</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_4-match-phrase-短语匹配" class="router-link-active router-link-exact-active toc-link level2">4. match_phrase-短语匹配</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_5-multi-math-多字段匹配" class="router-link-active router-link-exact-active toc-link level2">5. multi_math-多字段匹配</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_6-bool-复合查询" class="router-link-active router-link-exact-active toc-link level2">6. bool-复合查询</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_7-filter-结果过滤" class="router-link-active router-link-exact-active toc-link level2">7. filter-结果过滤</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_8-term-精确检索" class="router-link-active router-link-exact-active toc-link level2">8. term-精确检索</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#_9-aggregation-执行聚合" class="router-link-active router-link-exact-active toc-link level2">9. Aggregation-执行聚合</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#聚合语法" class="router-link-active router-link-exact-active toc-link level3">聚合语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#示例1-搜索address中包含mill的所有人的年龄分布以及平均年龄" class="router-link-active router-link-exact-active toc-link level3">示例1-搜索address中包含mill的所有人的年龄分布以及平均年龄</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#示例2-按照年龄聚合-并且求这些年龄段的这些人的平均薪资" class="router-link-active router-link-exact-active toc-link level3">示例2-按照年龄聚合，并且求这些年龄段的这些人的平均薪资</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/study/enterprise/es/3-search-es.html#示例3-查出所有年龄分布-并且这些年龄段中m的平均薪资和f的平均薪资以及这个年龄段的总体平均薪资" class="router-link-active router-link-exact-active toc-link level3">示例3-查出所有年龄分布，并且这些年龄段中M的平均薪资和F的平均薪资以及这个年龄段的总体平均薪资</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="_3-检索进阶" tabindex="-1"><a class="header-anchor" href="#_3-检索进阶" aria-hidden="true">#</a> 3-检索进阶</h1><h1 id="本节参考-官方文档-检索示例" tabindex="-1"><a class="header-anchor" href="#本节参考-官方文档-检索示例" aria-hidden="true">#</a> 本节参考 <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started-search.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 检索示例：</h1><h1 id="导入样本测试数据" tabindex="-1"><a class="header-anchor" href="#导入样本测试数据" aria-hidden="true">#</a> 导入样本测试数据</h1><p>准备一份顾客银行账户信息的虚构的JSON文档样本。每个文档都有下列的 schema（模式）。</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>{
    <span class="token string">&quot;account_number&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">&quot;balance&quot;</span><span class="token operator">:</span> <span class="token number">39225</span><span class="token punctuation">,</span>
    <span class="token string">&quot;firstname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Amber&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;lastname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Duke&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;age&quot;</span><span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
    <span class="token string">&quot;gender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;880 Holmes Lane&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;employer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Pyrami&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amberduke@pyrami.com&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;city&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Brogan&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;state&quot;</span><span class="token operator">:</span> <span class="token string">&quot;IL&quot;</span>
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="https://github.com/elastic/elasticsearch/blob/v6.8.18/docs/src/test/resources/accounts.json" target="_blank" rel="noopener noreferrer">https://github.com/elastic/elasticsearch/blob/v6.8.18/docs/src/test/resources/accounts.json<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 导入测试数据。 <code>POST bank/account/_bulk</code><img src="https://cdn.liuhongjiao.cn/images/2023/02/15/3-search-es/1676425762572.png" alt="图 1" loading="lazy"></p><h1 id="检索示例介绍" tabindex="-1"><a class="header-anchor" href="#检索示例介绍" aria-hidden="true">#</a> 检索示例介绍</h1><p>下面的请求都是在Kibana dev-tools 操作</p><h2 id="请求接口" tabindex="-1"><a class="header-anchor" href="#请求接口" aria-hidden="true">#</a> 请求接口</h2><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>GET <span class="token operator">/</span>bank<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;match_all&quot;</span><span class="token operator">:</span> {}
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    {
      <span class="token string">&quot;account_number&quot;</span><span class="token operator">:</span> <span class="token string">&quot;asc&quot;</span>
    }
  <span class="token punctuation">]</span>
}
# query 查询条件
# sort 排序条件
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="结果" tabindex="-1"><a class="header-anchor" href="#结果" aria-hidden="true">#</a> 结果</h2><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>{
  <span class="token string">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
  <span class="token string">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token string">&quot;_shards&quot;</span> <span class="token operator">:</span> {
    <span class="token string">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;hits&quot;</span> <span class="token operator">:</span> {
    <span class="token string">&quot;total&quot;</span> <span class="token operator">:</span> {
      <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token string">&quot;relation&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
    }<span class="token punctuation">,</span>
    <span class="token string">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token string">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      {
        <span class="token string">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;bank&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;account&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;_score&quot;</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        <span class="token string">&quot;_source&quot;</span> <span class="token operator">:</span> {
          <span class="token string">&quot;account_number&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          <span class="token string">&quot;balance&quot;</span> <span class="token operator">:</span> <span class="token number">16623</span><span class="token punctuation">,</span>
          <span class="token string">&quot;firstname&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Bradshaw&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;lastname&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Mckenzie&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">29</span><span class="token punctuation">,</span>
          <span class="token string">&quot;gender&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;F&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;244 Columbus Place&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;employer&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Euron&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;email&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;bradshawmckenzie@euron.com&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;city&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Hobucken&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;state&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;CO&quot;</span>
        }<span class="token punctuation">,</span>
        <span class="token string">&quot;sort&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">0</span>
        <span class="token punctuation">]</span>
      }<span class="token punctuation">,</span>
      <span class="token operator">..</span><span class="token punctuation">.</span>
    <span class="token punctuation">]</span>
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="响应字段解释" tabindex="-1"><a class="header-anchor" href="#响应字段解释" aria-hidden="true">#</a> 响应字段解释</h2><ul><li><code>took</code> – how long it took Elasticsearch to run the query, in milliseconds</li><li><code>timed_out</code> – whether or not the search request timed out</li><li><code>_shards</code> – how many shards were searched and a breakdown of how many shards succeeded, failed, or were skipped.</li><li><code>max_score</code> – the score of the most relevant document found</li><li><code>hits.total.value</code> - how many matching documents were found</li><li><code>hits.sort</code> - the document’s sort position (when not sorting by relevance score)</li><li><code>hits._score</code> - the document’s relevance score (not applicable when using <code>match_all</code>)</li></ul><h2 id="响应结果说明" tabindex="-1"><a class="header-anchor" href="#响应结果说明" aria-hidden="true">#</a> 响应结果说明</h2><p>Elasticsearch 默认会分页返回10条数据，不会一下返回所有数据。</p><h2 id="请求方式说明" tabindex="-1"><a class="header-anchor" href="#请求方式说明" aria-hidden="true">#</a> 请求方式说明</h2><p>ES支持两种基本方式检索；</p><ul><li>通过REST request uri 发送搜索参数 （uri +检索参数）；</li><li>通过REST request body 来发送它们（uri+请求体）；</li></ul><p>也就是说除了上面示例的请求接口，根据请求体进行检索外； 还可以用GET请求参数的方式检索：</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>GET bank<span class="token operator">/</span>_search?q<span class="token operator">=</span><span class="token operator">*</span>&amp;sort<span class="token operator">=</span>account_number<span class="token operator">:</span><span class="token keyword">asc</span>
# q<span class="token operator">=</span><span class="token operator">*</span> 查询所有
# sort<span class="token operator">=</span>account_number<span class="token operator">:</span><span class="token keyword">asc</span> 按照account_number进行升序排列
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="query-dsl" tabindex="-1"><a class="header-anchor" href="#query-dsl" aria-hidden="true">#</a> Query DSL</h1><p>本小节参考官方文档：<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html" target="_blank" rel="noopener noreferrer">Query DSL<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> Elasticsearch提供了一个可以执行查询的Json风格的DSL。这个被称为Query DSL，该查询语言非常全面。</p><h2 id="_1-基本语法格式" tabindex="-1"><a class="header-anchor" href="#_1-基本语法格式" aria-hidden="true">#</a> 1. 基本语法格式</h2><p>一个查询语句的典型结构:</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>QUERY_NAME<span class="token operator">:</span>{
   ARGUMENT<span class="token operator">:</span><span class="token keyword">VALUE</span><span class="token punctuation">,</span>
   ARGUMENT<span class="token operator">:</span><span class="token keyword">VALUE</span><span class="token punctuation">,</span><span class="token operator">..</span><span class="token punctuation">.</span>
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果针对于某个字段，那么它的结构如下：</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>{
  QUERY_NAME<span class="token operator">:</span>{
     FIELD_NAME<span class="token operator">:</span>{
       ARGUMENT<span class="token operator">:</span><span class="token keyword">VALUE</span><span class="token punctuation">,</span>
       ARGUMENT<span class="token operator">:</span><span class="token keyword">VALUE</span><span class="token punctuation">,</span><span class="token operator">..</span><span class="token punctuation">.</span>
      }   
   }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>请求示例：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;account_number&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;order&quot;</span><span class="token operator">:</span> <span class="token string">&quot;desc&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;balance&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      	<span class="token property">&quot;order&quot;</span><span class="token operator">:</span> <span class="token string">&quot;asc&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

# match_all 查询类型【代表查询所有的所有】，es中可以在query中组合非常多的查询类型完成复杂查询；
# from+size 限定，完成分页功能；从第几条数据开始，每页有多少数据
# sort 排序，多字段排序，会在前序字段相等时后续字段内部排序，否则以前序为准；
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-返回部分字段" tabindex="-1"><a class="header-anchor" href="#_2-返回部分字段" aria-hidden="true">#</a> 2. 返回部分字段</h2><p>请求示例：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;account_number&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;order&quot;</span><span class="token operator">:</span> <span class="token string">&quot;desc&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;balance&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;firstname&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

# _source 指定返回结果中包含的字段名
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果示例：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token property">&quot;relation&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;bank&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;account&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;999&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_score&quot;</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;firstname&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Dorothy&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;balance&quot;</span> <span class="token operator">:</span> <span class="token number">6087</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;sort&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token number">999</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    	...
    <span class="token punctuation">]</span>
 	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-match-匹配查询" tabindex="-1"><a class="header-anchor" href="#_3-match-匹配查询" aria-hidden="true">#</a> 3. match-匹配查询</h2><h3 id="精确查询-基本数据类型-非文本" tabindex="-1"><a class="header-anchor" href="#精确查询-基本数据类型-非文本" aria-hidden="true">#</a> 精确查询-基本数据类型(非文本)</h3><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;account_number&quot;</span><span class="token operator">:</span> <span class="token number">20</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# 查找匹配 account_number 为 <span class="token number">20</span> 的数据 非文本推荐使用 term
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="模糊查询-文本字符串" tabindex="-1"><a class="header-anchor" href="#模糊查询-文本字符串" aria-hidden="true">#</a> 模糊查询-文本字符串</h3><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill lane&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# 查找匹配 address 包含 mill 或 lane 的数据
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>match即全文检索，对检索字段进行分词匹配，会按照响应的评分 _score 排序，原理是倒排索引。</p><h3 id="精确匹配-文本字符串" tabindex="-1"><a class="header-anchor" href="#精确匹配-文本字符串" aria-hidden="true">#</a> 精确匹配-文本字符串</h3><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;address.keyword&quot;</span><span class="token operator">:</span> <span class="token string">&quot;288 Mill Street&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# 查找 address 为 <span class="token number">288</span> Mill Street 的数据。
# 这里的查找是精确查找，只有完全匹配时才会查找出存在的记录，
# 如果想模糊查询应该使用match_phrase 短语匹配
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-match-phrase-短语匹配" tabindex="-1"><a class="header-anchor" href="#_4-match-phrase-短语匹配" aria-hidden="true">#</a> 4. match_phrase-短语匹配</h2><p>将需要匹配的值当成一整个单词（不分词）进行检索</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match_phrase&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill lane&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# 这里会检索 address 匹配包含短语 mill lane 的数据
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-multi-math-多字段匹配" tabindex="-1"><a class="header-anchor" href="#_5-multi-math-多字段匹配" aria-hidden="true">#</a> 5. multi_math-多字段匹配</h2><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;multi_match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;city&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;address&quot;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# 检索 city 或 address 匹配包含 mill 的数据，会对查询条件分词
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-bool-复合查询" tabindex="-1"><a class="header-anchor" href="#_6-bool-复合查询" aria-hidden="true">#</a> 6. bool-复合查询</h2><p>复合语句可以合并，任何其他查询语句，包括符合语句。这也就意味着，复合语句之间 可以互相嵌套，可以表达非常复杂的逻辑。</p><ul><li>must：必须达到must所列举的所有条件</li><li>must_not，必须不匹配must_not所列举的所有条件。</li><li>should，应该满足should所列举的条件。</li></ul><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>GET bank<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;bool&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        {
          <span class="token string">&quot;match&quot;</span><span class="token operator">:</span> {
            <span class="token string">&quot;gender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;M&quot;</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;match&quot;</span><span class="token operator">:</span> {
            <span class="token string">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill&quot;</span>
          }
        }
      <span class="token punctuation">]</span>
    }
  }
}
# 查询 gender 为 M 且 address 包含 mill 的数据
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-filter-结果过滤" tabindex="-1"><a class="header-anchor" href="#_7-filter-结果过滤" aria-hidden="true">#</a> 7. filter-结果过滤</h2><p>并不是所有的查询都需要产生分数，特别是哪些仅用于filtering过滤的文档。为了不计算分数，elasticsearch会自动检查场景并且优化查询的执行。 filter 对结果进行过滤，且不计算相关性得分。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;balance&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;gte&quot;</span><span class="token operator">:</span> <span class="token string">&quot;10000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;lte&quot;</span><span class="token operator">:</span> <span class="token string">&quot;20000&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# 这里先是查询所有匹配 address 包含 mill 的文档，
# 然后再根据 <span class="token number">10000</span>&lt;=balance&lt;=<span class="token number">20000</span> 进行过滤查询结果
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>Each <code>must</code>, <code>should</code>, and <code>must_not</code> element in a Boolean query is referred to as a query clause. How well a document meets the criteria in each <code>must</code> or <code>should</code> clause contributes to the document’s <em>relevance score</em>. The higher the score, the better the document matches your search criteria. By default, Elasticsearch returns documents ranked by these relevance scores. 在boolean查询中，<code>must</code>, <code>should</code> 和<code>must_not</code> 元素都被称为查询子句 。 文档是否符合每个“must”或“should”子句中的标准，决定了文档的“相关性得分”。 得分越高，文档越符合您的搜索条件。 默认情况下，Elasticsearch 返回根据这些相关性得分排序的文档。</p><p>The criteria in a <code>must_not</code> clause is treated as a <em>filter</em>. It affects whether or not the document is included in the results, but does not contribute to how documents are scored. You can also explicitly specify arbitrary filters to include or exclude documents based on structured data. <code>“must_not”子句中的条件被视为“过滤器”。</code> 它影响文档是否包含在结果中，但<strong>不影响文档的评分方式</strong>。还可以显式地指定任意过滤器来包含或排除基于结构化数据的文档。</p></blockquote><h2 id="_8-term-精确检索" tabindex="-1"><a class="header-anchor" href="#_8-term-精确检索" aria-hidden="true">#</a> 8. term-精确检索</h2><blockquote><p>Avoid using the <code>term</code> query for <code>[text](https://www.elastic.co/guide/en/elasticsearch/reference/7.11/text.html)</code> fields. 避免使用 term 查询文本字段 By default, Elasticsearch changes the values of <code>text</code> fields as part of <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.11/analysis.html" target="_blank" rel="noopener noreferrer">analysis<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. This can make finding exact matches for <code>text</code> field values difficult. 默认情况下，Elasticsearch 会通过<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.11/analysis.html" target="_blank" rel="noopener noreferrer">analysis<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>分词将文本字段的值拆分为一部分，这使精确匹配文本字段的值变得困难。 To search <code>text</code> field values, use the <code>[match](https://www.elastic.co/guide/en/elasticsearch/reference/7.11/query-dsl-match-query.html)</code> query instead. 如果要查询文本字段值，请使用 match 查询代替。</p><p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.11/query-dsl-term-query.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/reference/7.11/query-dsl-term-query.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>在上面<a href="#NHBEH">3.match-匹配查询</a>中有介绍对于非文本字段的精确查询，Elasticsearch 官方对于这种非文本字段，使用 term来精确检索是一个推荐的选择。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token string">&quot;28&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# 查找 age 为 <span class="token number">28</span> 的数据
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9-aggregation-执行聚合" tabindex="-1"><a class="header-anchor" href="#_9-aggregation-执行聚合" aria-hidden="true">#</a> 9. Aggregation-执行聚合</h2><p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.11/search-aggregations.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/reference/7.11/search-aggregations.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="聚合语法" tabindex="-1"><a class="header-anchor" href="#聚合语法" aria-hidden="true">#</a> 聚合语法</h3><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>GET /my-index<span class="token number">-000001</span>/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;aggs_name&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span> # 这次聚合的名字，方便展示在结果集中
        <span class="token property">&quot;AGG_TYPE&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span> # 聚合的类型(avg<span class="token punctuation">,</span>term<span class="token punctuation">,</span>terms)
        <span class="token punctuation">}</span>	
     <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="示例1-搜索address中包含mill的所有人的年龄分布以及平均年龄" tabindex="-1"><a class="header-anchor" href="#示例1-搜索address中包含mill的所有人的年龄分布以及平均年龄" aria-hidden="true">#</a> 示例1-搜索address中包含mill的所有人的年龄分布以及平均年龄</h3><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Mill&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;ageAgg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;terms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">10</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ageAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;balanceAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
# <span class="token property">&quot;ageAgg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>   				  --- 聚合名为 ageAgg
#   <span class="token property">&quot;terms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>				    --- 聚合类型为 term
#     <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>     --- 聚合字段为 age
#     <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">10</span>			    --- 取聚合后前十个数据
#   <span class="token punctuation">}</span>
# <span class="token punctuation">}</span><span class="token punctuation">,</span>
# ------------------------
# <span class="token property">&quot;ageAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>   				  --- 聚合名为 ageAvg
#   <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>				      --- 聚合类型为 avg 求平均值
#     <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span>	    --- 聚合字段为 age
#   <span class="token punctuation">}</span>
# <span class="token punctuation">}</span><span class="token punctuation">,</span>
# ------------------------
# <span class="token property">&quot;balanceAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>				  --- 聚合名为 balanceAvg
#   <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>				      --- 聚合类型为 avg 求平均值
#     <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>  --- 聚合字段为 balance
#   <span class="token punctuation">}</span>
# <span class="token punctuation">}</span>
# ------------------------
# <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">0</span>               --- 不显示命中结果，只看聚合信息
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果：</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>{
  <span class="token string">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token string">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token string">&quot;_shards&quot;</span> <span class="token operator">:</span> {
    <span class="token string">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;hits&quot;</span> <span class="token operator">:</span> {
    <span class="token string">&quot;total&quot;</span> <span class="token operator">:</span> {
      <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token string">&quot;relation&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
    }<span class="token punctuation">,</span>
    <span class="token string">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token string">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;aggregations&quot;</span> <span class="token operator">:</span> {
    <span class="token string">&quot;ageAgg&quot;</span> <span class="token operator">:</span> {
      <span class="token string">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token string">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token string">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">2</span>
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        }
      <span class="token punctuation">]</span>
    }<span class="token punctuation">,</span>
    <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
      <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">34.0</span>
    }<span class="token punctuation">,</span>
    <span class="token string">&quot;balanceAvg&quot;</span> <span class="token operator">:</span> {
      <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">25208.0</span>
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="示例2-按照年龄聚合-并且求这些年龄段的这些人的平均薪资" tabindex="-1"><a class="header-anchor" href="#示例2-按照年龄聚合-并且求这些年龄段的这些人的平均薪资" aria-hidden="true">#</a> 示例2-按照年龄聚合，并且求这些年龄段的这些人的平均薪资</h3><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>GET bank/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;ageAgg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;terms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">100</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;ageAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果：</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>{
  <span class="token string">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
  <span class="token string">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token string">&quot;_shards&quot;</span> <span class="token operator">:</span> {
    <span class="token string">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;hits&quot;</span> <span class="token operator">:</span> {
    <span class="token string">&quot;total&quot;</span> <span class="token operator">:</span> {
      <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token string">&quot;relation&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
    }<span class="token punctuation">,</span>
    <span class="token string">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token string">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;aggregations&quot;</span> <span class="token operator">:</span> {
    <span class="token string">&quot;ageAgg&quot;</span> <span class="token operator">:</span> {
      <span class="token string">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token string">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token string">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">61</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">28312.918032786885</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">25269.583333333332</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">59</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">23194.813559322032</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">52</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">23951.346153846152</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">52</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">22136.69230769231</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">52</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">22174.71153846154</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">51</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">24731.07843137255</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">51</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">28273.882352941175</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">33</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">25093.94</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">34</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">49</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">26809.95918367347</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">47</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">22841.106382978724</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">46</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">26981.434782608696</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">45</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">27183.17777777778</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">44</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">27741.227272727272</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">27314.214285714286</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">28519.04761904762</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">27445.214285714286</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">37</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">27022.261904761905</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">27</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">21471.871794871793</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">26187.17948717949</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">29</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
          <span class="token string">&quot;ageAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">29483.14285714286</span>
          }
        }
      <span class="token punctuation">]</span>
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="示例3-查出所有年龄分布-并且这些年龄段中m的平均薪资和f的平均薪资以及这个年龄段的总体平均薪资" tabindex="-1"><a class="header-anchor" href="#示例3-查出所有年龄分布-并且这些年龄段中m的平均薪资和f的平均薪资以及这个年龄段的总体平均薪资" aria-hidden="true">#</a> 示例3-查出所有年龄分布，并且这些年龄段中M的平均薪资和F的平均薪资以及这个年龄段的总体平均薪资</h3><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>GET bank<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;match_all&quot;</span><span class="token operator">:</span> {}
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;aggs&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;ageAgg&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;terms&quot;</span><span class="token operator">:</span> {
        <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">100</span>
      }<span class="token punctuation">,</span>
      <span class="token string">&quot;aggs&quot;</span><span class="token operator">:</span> {
        <span class="token string">&quot;genderAgg&quot;</span><span class="token operator">:</span> {
          <span class="token string">&quot;terms&quot;</span><span class="token operator">:</span> {
            <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gender.keyword&quot;</span>
          }<span class="token punctuation">,</span>
          <span class="token string">&quot;aggs&quot;</span><span class="token operator">:</span> {
            <span class="token string">&quot;balanceAvg&quot;</span><span class="token operator">:</span> {
              <span class="token string">&quot;avg&quot;</span><span class="token operator">:</span> {
                <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
              }
            }
          }
        }<span class="token punctuation">,</span>
        <span class="token string">&quot;ageBalanceAvg&quot;</span><span class="token operator">:</span> {
          <span class="token string">&quot;avg&quot;</span><span class="token operator">:</span> {
            <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
          }
        }
      }
    }
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
}
# <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gender.keyword&quot;</span> gender是txt没法聚合 必须加<span class="token punctuation">.</span>keyword精确替代
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果：</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>{
  <span class="token string">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
  <span class="token string">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token string">&quot;_shards&quot;</span> <span class="token operator">:</span> {
    <span class="token string">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;hits&quot;</span> <span class="token operator">:</span> {
    <span class="token string">&quot;total&quot;</span> <span class="token operator">:</span> {
      <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token string">&quot;relation&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
    }<span class="token punctuation">,</span>
    <span class="token string">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token string">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;aggregations&quot;</span> <span class="token operator">:</span> {
    <span class="token string">&quot;ageAgg&quot;</span> <span class="token operator">:</span> {
      <span class="token string">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token string">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token string">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">61</span><span class="token punctuation">,</span>
          <span class="token string">&quot;genderAgg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
              {
                <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
                <span class="token string">&quot;balanceAvg&quot;</span> <span class="token operator">:</span> {
                  <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">29565.628571428573</span>
                }
              }<span class="token punctuation">,</span>
              {
                <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;F&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span>
                <span class="token string">&quot;balanceAvg&quot;</span> <span class="token operator">:</span> {
                  <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">26626.576923076922</span>
                }
              }
            <span class="token punctuation">]</span>
          }<span class="token punctuation">,</span>
          <span class="token string">&quot;ageBalanceAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">28312.918032786885</span>
          }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
          <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
          <span class="token string">&quot;genderAgg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
              {
                <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;F&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
                <span class="token string">&quot;balanceAvg&quot;</span> <span class="token operator">:</span> {
                  <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">26348.684210526317</span>
                }
              }<span class="token punctuation">,</span>
              {
                <span class="token string">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
                <span class="token string">&quot;balanceAvg&quot;</span> <span class="token operator">:</span> {
                  <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">23405.68181818182</span>
                }
              }
            <span class="token punctuation">]</span>
          }<span class="token punctuation">,</span>
          <span class="token string">&quot;ageBalanceAvg&quot;</span> <span class="token operator">:</span> {
            <span class="token string">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">25269.583333333332</span>
          }
        }<span class="token punctuation">,</span>
        <span class="token operator">..</span><span class="token punctuation">.</span>
      <span class="token punctuation">]</span>
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="检索示例代码" tabindex="-1"><a class="header-anchor" href="#检索示例代码" aria-hidden="true">#</a> 检索示例代码</h1><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code># <span class="token number">9</span><span class="token operator">:</span>Aggregation<span class="token operator">-</span>执行聚合
#示例<span class="token number">3</span><span class="token operator">-</span>查出所有年龄分布，并且这些年龄段中M的平均薪资和F的平均薪资以及这个年龄段的总体平均薪资
GET accounts<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;match_all&quot;</span><span class="token operator">:</span> {}
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;aggs&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;ageAgg&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;terms&quot;</span><span class="token operator">:</span> {
        <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">100</span>
      }<span class="token punctuation">,</span>
      <span class="token string">&quot;aggs&quot;</span><span class="token operator">:</span> {
        <span class="token string">&quot;genderAgg&quot;</span><span class="token operator">:</span> {
          <span class="token string">&quot;terms&quot;</span><span class="token operator">:</span> {
            <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gender.keyword&quot;</span>
          }<span class="token punctuation">,</span>
          <span class="token string">&quot;aggs&quot;</span><span class="token operator">:</span> {
            <span class="token string">&quot;balanceAvg&quot;</span><span class="token operator">:</span> {
              <span class="token string">&quot;avg&quot;</span><span class="token operator">:</span> {
                <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
              }
            }
          }
        }<span class="token punctuation">,</span>
        <span class="token string">&quot;ageBalanceAvg&quot;</span><span class="token operator">:</span> {
          <span class="token string">&quot;avg&quot;</span><span class="token operator">:</span> {
            <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
          }
        }
      }
    }
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
}
# <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gender.keyword&quot;</span> gender是txt没法聚合 必须加<span class="token punctuation">.</span>keyword精确替代

# 示例<span class="token number">2</span><span class="token operator">-</span>按照年龄聚合，并且求这些年龄段的这些人的平均薪资
GET accounts<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;match_all&quot;</span><span class="token operator">:</span> {}
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;aggs&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;ageAgg&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;terms&quot;</span><span class="token operator">:</span> {
        <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">100</span>
      }<span class="token punctuation">,</span>
      <span class="token string">&quot;aggs&quot;</span><span class="token operator">:</span> {
        <span class="token string">&quot;ageAvg&quot;</span><span class="token operator">:</span> {
          <span class="token string">&quot;avg&quot;</span><span class="token operator">:</span> {
            <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
          }
        }
      }
    }
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
}


# 示例<span class="token number">1</span><span class="token operator">-</span>搜索address中包含mill的所有人的年龄分布以及平均年龄
GET accounts<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;match&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Mill&quot;</span>
    }
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;aggs&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;ageAgg&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;terms&quot;</span><span class="token operator">:</span> {
        <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">10</span>
      }
    }<span class="token punctuation">,</span>
    <span class="token string">&quot;ageAvg&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;avg&quot;</span><span class="token operator">:</span> {
        <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span>
      }
    }<span class="token punctuation">,</span>
    <span class="token string">&quot;balanceAvg&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;avg&quot;</span><span class="token operator">:</span> {
        <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
      }
    }
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
}
# <span class="token string">&quot;ageAgg&quot;</span><span class="token operator">:</span> {   				  <span class="token comment">--- 聚合名为 ageAgg</span>
#   <span class="token string">&quot;terms&quot;</span><span class="token operator">:</span> {				    <span class="token comment">--- 聚合类型为 term</span>
#     <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>     <span class="token comment">--- 聚合字段为 age</span>
#     <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">10</span>			    <span class="token comment">--- 取聚合后前十个数据</span>
#   }
# }<span class="token punctuation">,</span>
# <span class="token comment">------------------------</span>
# <span class="token string">&quot;ageAvg&quot;</span><span class="token operator">:</span> {   				  <span class="token comment">--- 聚合名为 ageAvg</span>
#   <span class="token string">&quot;avg&quot;</span><span class="token operator">:</span> {				      <span class="token comment">--- 聚合类型为 avg 求平均值</span>
#     <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span>	    <span class="token comment">--- 聚合字段为 age</span>
#   }
# }<span class="token punctuation">,</span>
# <span class="token comment">------------------------</span>
# <span class="token string">&quot;balanceAvg&quot;</span><span class="token operator">:</span> {				  <span class="token comment">--- 聚合名为 balanceAvg</span>
#   <span class="token string">&quot;avg&quot;</span><span class="token operator">:</span> {				      <span class="token comment">--- 聚合类型为 avg 求平均值</span>
#     <span class="token string">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>  <span class="token comment">--- 聚合字段为 balance</span>
#   }
# }
# <span class="token comment">------------------------</span>
# <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">0</span>               <span class="token comment">--- 不显示命中结果，只看聚合信息</span>

# <span class="token number">8</span>：term<span class="token operator">-</span>精确检索
GET accounts<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;term&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;age&quot;</span><span class="token operator">:</span> <span class="token string">&quot;28&quot;</span>
    }
  }
}
# 查找 age 为 <span class="token number">28</span> 的数据

# <span class="token number">7</span>：filter<span class="token operator">-</span>结果过滤
GET <span class="token operator">/</span>accounts<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;bool&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        {
          <span class="token string">&quot;match&quot;</span><span class="token operator">:</span> {
            <span class="token string">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Road&quot;</span>
          }
        }
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> {
        <span class="token string">&quot;range&quot;</span><span class="token operator">:</span> {
          <span class="token string">&quot;balance&quot;</span><span class="token operator">:</span> {
            <span class="token string">&quot;gte&quot;</span><span class="token operator">:</span> <span class="token string">&quot;10000&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;lte&quot;</span><span class="token operator">:</span> <span class="token string">&quot;20000&quot;</span>
          }
        }
      }
    }
  }
}
# 这里先是查询所有匹配 address 包含 mill 的文档，
# 然后再根据 <span class="token number">10000</span><span class="token operator">&lt;=</span>balance<span class="token operator">&lt;=</span><span class="token number">20000</span> 进行过滤查询结果


# <span class="token number">6</span><span class="token operator">:</span>bool<span class="token operator">-</span>复合查询
GET <span class="token operator">/</span>accounts<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;bool&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        {<span class="token string">&quot;match&quot;</span><span class="token operator">:</span> {
          <span class="token string">&quot;gender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;M&quot;</span>
        }
        }<span class="token punctuation">,</span>
        {
          <span class="token string">&quot;match&quot;</span><span class="token operator">:</span> {
            <span class="token string">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill&quot;</span>
          }
        }
      <span class="token punctuation">]</span>
    }
  }
}
## 查询 gender 为 M 且 address 包含 mill 的数据 

# <span class="token number">5</span>：multi_math<span class="token operator">-</span>多字段匹配
GET <span class="token operator">/</span>accounts<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;multi_match&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;fields&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;city&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;address&quot;</span>
      <span class="token punctuation">]</span>
    }
  }
}
# 检索 city 或 address 匹配包含 mill 的数据，会对查询条件分词

# <span class="token number">4</span>：match_phrase<span class="token operator">-</span>短语匹配： 将需要匹配的值当成一整个单词（不分词）进行检索 
GET <span class="token operator">/</span>accounts<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;match_phrase&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill lane&quot;</span>
    }
  }
}

#<span class="token operator">:</span><span class="token number">3</span>：精确查询 <span class="token operator">-</span> 文本字符串
GET <span class="token operator">/</span>accounts<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;match&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;address.keyword&quot;</span><span class="token operator">:</span> <span class="token string">&quot;198 Mill Lane&quot;</span>
    }
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address&quot;</span>
}

#<span class="token operator">:</span><span class="token number">2</span>：模糊查询 <span class="token operator">-</span> 文本字符串
GET <span class="token operator">/</span>accounts<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;match&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill lane&quot;</span>
    }
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address&quot;</span>
}


#<span class="token operator">:</span><span class="token number">1</span>：精确查询<span class="token operator">-</span>基本数据类型<span class="token punctuation">(</span>非文本<span class="token punctuation">)</span>
GET <span class="token operator">/</span>accounts<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;match&quot;</span><span class="token operator">:</span> {
      <span class="token string">&quot;account_number&quot;</span><span class="token operator">:</span> <span class="token number">20</span>
    }
  }
}

GET <span class="token operator">/</span>accounts<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span>{
    <span class="token string">&quot;match_all&quot;</span><span class="token operator">:</span> {}
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;from&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
  <span class="token string">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    {
      <span class="token string">&quot;account_number&quot;</span><span class="token operator">:</span> {
        <span class="token string">&quot;order&quot;</span><span class="token operator">:</span> <span class="token string">&quot;desc&quot;</span>
      }<span class="token punctuation">,</span>
      <span class="token string">&quot;balance&quot;</span><span class="token operator">:</span> {
        <span class="token string">&quot;order&quot;</span><span class="token operator">:</span> <span class="token string">&quot;desc&quot;</span>
      }
    }
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;lastname&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;firstname&quot;</span><span class="token punctuation">]</span>}
  
GET <span class="token operator">/</span>accounts<span class="token operator">/</span>_search
{
  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> {
    <span class="token string">&quot;match_all&quot;</span><span class="token operator">:</span> {}
  }<span class="token punctuation">,</span>
  <span class="token string">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    {
      <span class="token string">&quot;account_number&quot;</span><span class="token operator">:</span> <span class="token string">&quot;asc&quot;</span>
    }
  <span class="token punctuation">]</span>
}
# query 查询条件
# sort 排序条件


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/master/docs/study/enterprise/es/3-search-es.md" rel="noopener noreferrer" target="_blank" aria-label="在GitHub上编辑" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在GitHub上编辑<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: liuhongjiao@koolearn.com">liuhongjiao</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><a href="/study/enterprise/es/2-hello-es.html" class="nav-link prev" aria-label="2-使用入门"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><span class="font-icon icon iconfont icon-edit" style=""></span>2-使用入门</div></a><a href="/study/enterprise/es/4-mapping-es.html" class="nav-link next" aria-label="4-Mapping"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">4-Mapping<span class="font-icon icon iconfont icon-edit" style=""></span></div></a></nav><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"><div style="width:600px;margin:0 auto; padding:20px 0;"><a target="_blank" href="https://beian.miit.gov.cn/"  style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">冀ICP备2023002189号-1</p></a><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11011402013606" style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img src="/beian_icon.png" style="float:left;"/><p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">京公网安备 11011402013606号</p></a></div></div><div class="copyright">Copyright © 2024 哇哩哇哩哇</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-8869829a.js" defer></script>
  </body>
</html>
